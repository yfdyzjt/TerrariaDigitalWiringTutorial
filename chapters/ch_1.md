## 第一章 基本概念

*这部分涉及一些基本概念，可以先跳过，在需要时回来阅读。*

### 1.1 泰拉瑞亚

#### 1.1.1 实体

实体指的是可以发生碰撞的物体，包括[NPC](https://terraria.wiki.gg/zh/wiki/NPC)、[人物（玩家）](https://terraria.wiki.gg/zh/wiki/%E4%BA%BA%E7%89%A9)、[射弹](https://terraria.wiki.gg/zh/wiki/%E5%B0%84%E5%BC%B9)、[物品（掉落物）](https://terraria.wiki.gg/zh/wiki/%E7%89%A9%E5%93%81)、[图格](https://terraria.wiki.gg/zh/wiki/%E5%9B%BE%E6%A0%BC_ID)等。


!!! example
    史莱姆对玩家造成接触伤害，是史莱姆（NPC）与玩家（人物）的碰撞；玩家用弓射出木箭击中了史莱姆，是史莱姆（NPC）与木箭（射弹）的碰撞；玩家被血肉墙激光击中，是玩家（人物）与激光（射弹）的碰撞；玩家、物品、大多数 NPC、大多数射弹不能穿墙，是因为玩家、物品、NPC、射弹会和图格碰撞。

碰撞是通过碰撞箱判定的，泰拉瑞亚中所有实体的碰撞箱均为矩形，有宽度和高度两个属性。

!!! example
    史莱姆与玩家碰撞，是因为史莱姆的碰撞箱与玩家的碰撞箱有重叠。

#### 1.1.2 上限

泰拉瑞亚中许多实体都有数量上限，而数量上限又分为硬上限和软上限。硬上限是游戏中的静态常量，软上限是游戏中的变量。

!!! example
    NPC 最多数量（硬上限） 200 ，活跃刷怪数量（软上限）一般在 5 到 15 。

从程序角度来说，硬上限是由定长数组的长度决定的，如果尝试突破会导致数组越界。为避免在正常游戏过程中出现崩溃现象，游戏程序中在关键函数中都有越界检查。而软上限是开发者对游戏的平衡控制。

!!! example
    NPC 达到上限时，游戏会拒绝生成新 NPC 以防止崩溃；玩家附近的活跃敌怪数量到达 15 则不会进行刷怪。

以下是一些电路中可能用到的硬上限：

| 对象 | 上限 |
| --- | --- |
| 傀儡影子 | 100 |
| NPC | 200 |
| 人物 | 255 |
| 射弹 | 1000 |
| 冷却机关 | 1000 |

#### 1.1.3 帧率

物理帧（tick） 指泰拉瑞亚中时间的最小单位，为 1/60 秒。在物理帧的尺度下，泰拉瑞亚是回合制游戏，每个物理帧中，除电路外所有的游戏机制会依一定顺序结算，电路结算的位置和触发电路的物理电源结算位置有关。本教程中未经特殊说明的情况下将直接用“帧”表示物理帧。

图像帧（frame）指泰拉瑞亚游戏过程中电脑显示屏更新的每帧画面，在游戏中按 F10 可以在游戏窗口左下角显示当前图像帧率。建议将跳帧设置为隐蔽以使图像帧和物理帧相等，跳帧开会在物理帧降低时通过降低图像帧以使物理帧达到最大，跳帧关会令图像帧和屏幕刷新率相等。

#### 1.1.4 坐标

图格的坐标指的是图格在世界中的位置。坐标并非深度计与罗盘所显示的那样。程序中的坐标是以世界左上角第一个图格为 (0, 0)，横坐标向右增加，纵坐标向下增加。世界右下角的坐标为 (世界宽度 - 1, 世界高度 - 1)。

以下是不同大小世界的宽度和高度，其中大世界是泰拉瑞亚中最大的世界：

| 世界 | 宽度 | 高度 |
| --- | --- | --- |
| 小世界 | 4200 | 1200 |
| 中世界 | 6400 | 1800 |
| 大世界 | 8400 | 2400 |

世界最外侧有一个区域在游戏中不可见且玩家不可到达的，区域内的图格仍然存在，可以在地图编辑器里面看到它们，世界上侧和左侧不可见区域大小是 41 格，下侧和右侧是 42 格。在不可见区域内的电路仍然可以正常运行，只有在世界最外侧 2 格宽的区域内的电路无法运行。

#### 1.1.5 度量

泰拉瑞亚中的长度单位有：英里、格、英尺、像素。换算关系是 1 英里 = 5280 英尺 = 2640 格，1 格 = 2 英尺 = 16 像素。

!!! tip
    尽管泰拉瑞亚的图格贴图是按照每个图格 8 × 8 像素绘制的，但是储存和计算时仍然是按照 16 × 16 像素。

!!! info
    在游戏中最大能看到 1920 × 1080 像素的范围，即便将游戏分辨率设置的更高，也会被强制缩放到这个范围内。

泰拉瑞亚中的时间单位有：帧、秒、分、天。换算关系是 1 天 = 24 分，1 分 = 60 秒，1 秒 = 60 帧。有的时候帧、秒、分也分别叫做游戏秒、游戏分、游戏时。

速度单位 = 长度单位/时间单位，主要有：英里/小时、格/秒、像素/帧。

程序内部的长度单位是像素，时间单位是帧，速度单位是像素/帧。

### 1.2 数字电路

#### 1.2.1 模拟电路与数字电路

在现实中存在着许多物理量，其中有一些物理量，比如温度、湿度、压力、速度等，它们在时间上和数值上都具有连续变化的特点，在一定范围内可以取任意实数值，通常称这种连续变化的物理量为模拟量，表示模拟量的电信号称为模拟信号。而处理模拟信号的电路称为模拟电路。

还有一类物理量在时间和数值上都是离散的，它们的大小以及每次的增减变化都是某个最小单位的整数倍。比如每年的利润，若最小单位为元，显然它只能以元为单位增加或减少，并且以年为时间单位记录。这一类物理量称为数字量，表示数字量的电信号称为数字信号。而处理数字信号的电路称为数字电路。

!!! info
    泰拉瑞亚的电路中并没有电压和电流这样的模拟量，电源、用电器和电线的状态在时间上和数值上都是离散的，泰拉瑞亚中只存在数字电路。

在数字电路中，最常用的是只由 0 和 1 两种数值组成的数字信号，这种二值数字信号又被称为二进制信号，这类信号中的数值 0 或 1 可以用电平的低或高来表示，也可以用脉冲的有或无来表示。数字电路中最小时间单位被称为周期，电路中所有变化都会以周期为单位发生。

!!! info
    泰拉瑞亚逻辑门电路的周期被称为逻辑帧，一个物理帧内可以有任意数量的逻辑帧。一个常见的错误是认为逻辑帧与物理帧相等，实际上在泰拉瑞亚中任意规模的电路都能在瞬间（一个物理帧内）计算完成，详细内容会在后文介绍。

!!! tip
    后文中的在描述电路时使用的“同时”指的是指某些事情在同一个周期（逻辑帧）内发生，它们的先后关系对结果没有影响。

数字电路中处理的电信号一般有两种，电平（状态）型数字信号和脉冲（激活）型数字信号。状态信号会在每个周期内维持一个状态（电平）不变，只有在周期间才会发生变化，一般设定高电平为 1、低电平为 0，所以又叫不归零型数字信号，通常关注状态信号在周期内的状态。

脉冲是一种特殊的信号，指电平在短时间内（小于一个周期）突变，随后又迅速返回初始值的变化过程。对于激活信号，一般设定有脉冲为 1、无脉冲为 0，在每个周期中除了有脉冲的瞬间外，会一直维持低电平，所以又叫归零型数字信号，通常关注周期内是否有脉冲存在。

!!! info
    泰拉瑞亚的电线中传递的只有激活信号，而在电源和用电器中存在状态信号和激活信号，其中逻辑门电路中只有 0 和 1 两种数值所组成的二进制数字信号。



!!! example
    ```wavedrom
    { 
      signal : [
      { name: "a", wave: "h..lhlh."},
      { name: "b", wave: "p..lplpp"}
      ],
      head : {
       tick: 0,
       every: 1
      }
    }
    ```

    上图为两个数字信号 a 与 b 的波形图，信号内容都是 $(11101011)_2$ ，波形图是反映信号的幅值（电平）随时间的变化图像。

    * 信号 a 是以高电平代表 $1$ ，低电平代表 $0$ ，称为状态（电平）型数字信号或不归零型数字信号；
    * 信号 b 是以有脉冲代表 $1$ ，无脉冲代表 $0$ ，称为激活（脉冲）型数字信号或归零型数字信号；
    
    脉冲除了是方波以外，还可以是三角波、正弦波、尖顶余弦等等，我们并不关心其波形与持续时间，只关心它是否存在。

#### 1.2.2 进制

按进位规则进行计数称为进位计数制，简称进制。在日常生活中我们最广泛使用的是十进制（Decimal），十进制有 0 ~ 9 十个数字。但在数字电路和计算机中，通常只有类似灯的亮灭、电线的通断、开关的闭合和抬起，这样的两种状态，所以只需要 0 和 1 两个数字来表示，使用的是二进制（Binary）。

!!! info
    在泰拉瑞亚逻辑门电路中，只有二进制信号，所以其它类型的信号，比如数字、文字、图像、视频、程序等信息，需要先使用特定的编码转换为二进制信号，才能在电路中传输和处理。处理完成后，由需要将二进制信号转换为其它类型的信号进行表示。

十进制数可以被写做 $(345)_{10}$ ，读做“三百四十五”，这种使用 0 ~ 9 十个数字，每个数字在不同的数位上表示的大小不同的形式，被称为位置记数法。

!!! tip
    下角标 10 表示括号里的数是十进制，下角标 2 表示括号里的数是二进制，以此类推。

在十进制中，由于只有 0 ~ 9 十个数字，当表示大于 9 的数时，需要进行进位，也就是满 10 进 1 ， 9 + 1 = 10 。当 1 在十位上时，它是个位上的 1 的十倍。对于十进制数 $(345)_{10}$ ，3 在百位上，4 在十位上，5 在个位上；3 代表有三个 100，4 代表有四个 10，5 代表有五个 1。这里的 100、10、1 ，也就是 $10 ^ 2$、$10 ^ 1$、$10 ^ 0$ 是十进制数的位权，十进制数的各个数位的位权是 10 的位数次幂，幂数的底 10 被称为基数，几进制的基数就是几。十进制数第 $n$ 位数的位权是 $10 ^ {n-1}$。

$$ (345)_{10} = 3 \times 10 ^ 2 + 4 \times 10 ^ 1 + 5 \times 10 ^ 0 $$

!!! info
    这种把一个数字的每一数位拆开，写成数码乘以位权的形式，被称为位权展开式。

同理，二进制中满足满 2 进 1 的进位规则，二进制数也可以按照位置记数法，被写做形如 $(10010)_{2}$ 的形式，表示有 1 个 16，0 个 8，0 个 4，1 个 2，0 个 1。每位的乘数 16、8、4、2、1，也就是 $2 ^ 4$、$2 ^ 3$、$2 ^ 2$、$2 ^ 1$、$2 ^ 0$ 是二进制数的位权，而二进制数的基数是 2。二进制数第 $n$ 位数的位权是 $2 ^ {n-1}$。$R$ 进制数第 $n$ 位数的位权是 $R ^ {n-1}$

$$ (10010)_{2} = 1 \times 2 ^ 4 + 0 \times 2 ^ 3 + 0 \times 2 ^ 2 + 1 \times 2 ^ 1 + 0 \times 2 ^ 0 $$

!!! info
    任何进制的数字都可以写成位权表达式的形式，计算位权表达式的同时也能将其它进制的数字转换为十进制，而与之对应的，也可以使用短除法将十进制转换为其它进制的数字，详细内容会在后文介绍。

!!! example
    $$ (BEEF)_{16} = 11 \times 16 ^ 3 + 14 \times 16 ^ 2 + 14 \times 16 ^ 1 + 15 \times 16 ^ 0$$
    这是一个十六进制数字 $(BEEF)_{16}$ 的位权展开式，在十六进制中，会使用 $A$ ~ $F$ 来表示 $10$ ~ $15$ 六个数字。

!!! example
    $$ (a_{n−1} ​a_{n−2} \dots a_{1​} a_{0} . a_{-1} \dots a_{-m+1} a_{-m}​)_R​ = \sum_{i=-m}^{n-1} a_i \times R^{i} $$
    这是一个具有 $n$ 位整数和 $m$ 位小数的 $R$ 进制实数的位权展开式。

对于 3 位十进制数，可以表示 $(000)_{10}$ ~ $(999)_{10}$ ，共计 1000 （$10 ^ 3$）个数，也就是第四位的位权。同理对于五位二进制数，可以表示 $(00000)_{2}$ ~ $(11111)_{2}$ ，共计 32 （$2 ^ 5$）个数。由此可见，对于 $n$ 位二进制数，可以表示 $2 ^ n$ 个数；对于 $n$ 位 $R$ 进制数，可以表示 $R ^ n$ 个数。

#### 1.2.3 常用进制

10 并不是 2 的整数次幂，在十进制和二进制间转换是比较困难的。虽然在电路中使用的都是二进制，但是二进制的数码比较少，数字会比较长，难以阅读。而八进制和十六进制的基数是二的整数次幂，数码的数量相对较多，是电路和计算机中另外两个比较常用的进制。

| 进制 | 规则 | 数码 | 基数 | 位权 |
| --- | --- | --- | --- | --- |
| 二进制 | 逢二进一 | $0$ ~ $1$ | $2$ | $2 ^ {n-1}$ |
| 八进制 | 逢八进一 | $0$ ~ $7$ | $8$ | $8 ^ {n-1}$ |
| 十进制 | 逢十进一 | $0$ ~ $9$ | $10$ | $10 ^ {n-1}$ |
| 十六进制 | 逢十六进一 | $0$ ~ $9$, $A$ ~ $F$ | $16$ | $16 ^ {n-1}$ |

八进制和十六进制的基数分别是 8 和 16，所以每一位八进制和十六进制可以直接转换为 3 位和 4 位二进制，同理每 3 位和 4 位二进制也可以直接转换为一位八进制和十六进制。

!!! example
    $(1110\_0000\_0000\_0010)_{2} = (E002)_{16}$，$(101\_110\_111)_{2} = (567)_{8}$。

具体的对应关系可以在下方的速查表中找到，使用速查表可以快速的完成二进制与八进制与十六进制数字间的转换。

| 十进制 | 二进制 | 八进制 | 十六进制 |
| --- | --- | --- | --- |
| 0 | 0000 | 0 | 0 |
| 1 | 0001 | 1 | 1 |
| 2 | 0010 | 2 | 2 |
| 3 | 0011 | 3 | 3 |
| 4 | 0100 | 4 | 4 |
| 5 | 0101 | 5 | 5 |
| 6 | 0110 | 6 | 6 |
| 7 | 0111 | 7 | 7 |
| 8 | 1000 | 10 | 8 |
| 9 | 1001 | 11 | 9 |
| 10 | 1010 | 12 | A |
| 11 | 1011 | 13 | B |
| 12 | 1100 | 14 | C |
| 13 | 1101 | 15 | D |
| 14 | 1110 | 16 | E |
| 15 | 1111 | 17 | F |

对于十进制，可以将每一位十进制直接转换为 BCD（Binary-Coded Decimal）码，这种编码将十进制的 0 ~ 9 使用四位二进制来表示。

!!! example
    十进制数 $1857$ 可以使用 8421 BCD 码表示为 $0001\_1000\_0101\_0111$ 。

具体的对应关系可以在下方速查表中找到，使用速查表可以快速的完成十进制数字与 BCD 码间的转换。

| 十进制 | 8421 码 | 5421 码 | 余 3 码 | 格雷码 |
| --- | --- | --- | --- | --- |
| 0 | 0000 | 0000 | 0011 | 0000 |
| 1 | 0001 | 0001 | 0100 | 0001 |
| 2 | 0010 | 0010 | 0101 | 0011 |
| 3 | 0011 | 0011 | 0110 | 0010 |
| 4 | 0100 | 0100 | 0111 | 0110 |
| 5 | 0101 | 1000 | 1000 | 0111 |
| 6 | 0110 | 1001 | 1001 | 0101 |
| 7 | 0111 | 1010 | 1010 | 0100 |
| 8 | 1000 | 1011 | 1011 | 1100 |
| 9 | 1001 | 1100 | 1100 | 1101 |

!!! tip
    还有一些 BCD 码未列出（如 2421 码和余 3 循环码），读者可自行了解。最常用的 BCD 码是 8421 BCD 码，后文中提到的 BCD 码默认是 8421 BCD 码。

!!! info
    对于二进制、八进制、十六进制数字，除了使用下标 $2$、$8$、$16$，还可以使用前缀 0b、0o、0x，或后缀 B、O、H 来表示。十进制无前缀，后缀是 D。

!!! tip
    下文中十进制数字不会使用特殊表示，其它进制数字会使用前缀表示。

| 进制 | 英文 | 前缀 | 后缀 |
| --- | --- | --- | --- |
| 二进制 | Binary | 0b | B |
| 八进制 | Octal | 0o | O |
| 十进制 | Decimal | 无 | D |
| 十六进制 | Hexadecimal | 0x | H |

#### 1.2.4 逻辑函数

数字电路的基本单元是开关器件，开关器件只有“接通”和“断开”两种状态，可以使用逻辑变量（二值变量）来描述，逻辑变量只有 0 和 1 两种可能的取值，也就是一位二进制。

函数是一种将一个集合中的每个元素（自变量）与另一个集合中的一个元素（因变量）关联起来的关系，逻辑函数是研究逻辑变量之间的因果关系的函数。对于有 $n$ 个逻辑变量 $(A_1, A_2, \cdots, A_n)$ 的逻辑函数，当 $n$ 个逻辑变量取任意一组确定值后，逻辑函数 $Y = F(A_1, A_2, \cdots, A_n)$ 的值也就被唯一地确定了，显然 $Y$ 也只有 0 或 1 两种可能的取值。

!!! example
    存在一个两变量的逻辑函数 $Y = F(A, B)$ ，对于二位二进制，存在 $2 ^ 2 = 4$ 个不同的取值，所以对于变量 $A$，$B$ 有 4 种可能的取值：00，01，10，11。令 $F(0, 0) = 0$， $F(0, 1) = 0$， $F(1, 0) = 0$， $F(1, 1) = 1$ ，可得 $A$，$B$ 与 $Y$ 的完整映射关系。

    输入为 00 时，可知输出为 0；
    输入为 01 时，可知输出为 0；
    输入为 10 时，可知输出为 0；
    输入为 11 时，可知输出为 1。

对于 $n$ 变量的逻辑函数，存在 $2 ^ n$ 个可能的取值，当我们建立起全部可能的自变量取值与对应的因变量的完整映射关系，即可唯一确定逻辑函数。

#### 1.2.5 真值表

对于一个逻辑函数，我们可以使用真值表来描述它。真值表是一种列出一个逻辑函数的所有输入与其对应输出的表格。例如上一节所述函数，我们可以使用下面的真值表来描述：

!!! example
    | > | 输入 | 输出 |
    | --- | --- | --- |
    | A | B | Y |
    | 0 | 0 | 0 |
    | 0 | 1 | 0 |
    | 1 | 0 | 0 |
    | 1 | 1 | 1 |

    输入为 00 时，查表可知输出为 0；
    输入为 01 时，查表可知输出为 0；
    输入为 10 时，查表可知输出为 0；
    输入为 11 时，查表可知输出为 1。

对于 $n$ 个输入的逻辑函数，会有 $2 ^ n$ 个可能的输入取值，和与之对应的输出，真值表会有 $n + 1$ 列， $2 ^ n$ 行。

有时候部分输入情况是不存在或不需要考虑的，此时我们可以省略这些情况对应的行，或者将对应输出用 X 表示。

!!! example
    独热码是一种全部位中只有一位为 1 的二进制编码，所以对于一个输入为独热码的逻辑函数来说，非独热码的输入情况是不需要考虑的。

    | A | B | C | Y |
    | --- | --- | --- | --- |
    | 0 | 0 | 0 | X |
    | 0 | 0 | 1 | 0 |
    | 0 | 1 | 0 | 0 |
    | 0 | 1 | 1 | X |
    | 1 | 0 | 0 | 1 |
    | 1 | 0 | 1 | X |
    | 1 | 1 | 0 | X |
    | 1 | 1 | 1 | X |

    也可以表示为：

    | A | B | C | Y |
    | --- | --- | --- | --- |
    | 0 | 0 | 1 | 0 |
    | 0 | 1 | 0 | 0 |
    | 1 | 0 | 0 | 1 |

#### 1.2.6 基本逻辑运算

类似加、减、乘、除四则运算，在逻辑函数中，存在最基本的逻辑运算：**与、异或、非**。任何逻辑运算和任何逻辑函数都可以使用这三种运算来表示。

!!! info
    现实数电的基本逻辑运算是 **与、或、非**，产生这种区别的原因会在下文介绍。

##### 与（AND）

与运算用符号“ $\land$ ”表示，称为与。

与运算是二元运算，在所有输入都为 1 时，输出才为 1；有任一输入为 0 时输出为 0。

两个变量与运算的逻辑表达式为：

$$A \land B$$

!!! info
    读作 A 与 B。

两个变量与运算的真值表为：

| > | 输入 | 输出 |
| --- | --- | --- |
| A | B | Y |
| 0 | 0 | 0 |
| 0 | 1 | 0 |
| 1 | 0 | 0 |
| 1 | 1 | 1 |

$n$ 个变量与运算的逻辑表达式为：

$$A_1 \land A_2 \land \cdots \land A_n$$

!!! tip
    与满足结合律，多个变量与和多个变量两两与等价。

    $$A_1 \land A_2 \land \cdots \land A_n = (( \cdots ((A_1 \land A_2) \land A_3) \land \cdots) \land A_n)$$

##### 异或（XOR）

异或运算用符号“ $\oplus$ ”表示，称为异或。

异或运算是二元运算，在只有一个输入为 1 时，输出为 1；全部输入为 0 或 1 时输出为 0。

!!! info
    异或运算也叫奇校验，只有在全部输入中有奇数个 1 时输出才为 1，否则为 0。

两个变量异或运算的逻辑表达式为：

$$A \oplus B$$

!!! info
    读作 A 异或 B。

两个变量异或运算的真值表为：

| > | 输入 | 输出 |
| --- | --- | --- |
| A | B | Y |
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 0 |

$n$ 个变量异或运算的逻辑表达式为：

$$A_1 \oplus A_2 \oplus \cdots \oplus A_n$$

!!! tip
    异或满足结合律，多个变量异或和多个变量两两异或等价。

    $$A_1 \oplus A_2 \oplus \cdots \oplus A_n = (( \cdots ((A_1 \oplus A_2) \oplus A_3) \oplus \cdots) \oplus A_n)$$

##### 非（NOT）

非运算用符号“ $\lnot$ ”表示，称为非，非运算是一元运算。在输入为 0 时，输出 1；在输入为 1 时，输出 0。

!!! info
    非运算也叫反相运算，或者取反运算。

非运算的逻辑表达式为：

$$\lnot A$$

!!! info
    读作 A 非，非运算只能有一个逻辑变量输入。

非运算的真值表为：

| 输入 | 输出 |
| --- | --- |
| A | Y |
| 0 | 1 |
| 1 | 0 |

#### 1.2.7 逻辑表达式

上一节介绍了与、异或、非三种基本逻辑运算，以及对应的运算符号“ $\land$ ”、“ $\oplus$ ”、“ $\lnot$ ”，它们统称为逻辑运算符。由逻辑变量和逻辑运算符组成的表达式被称为逻辑函数表达式或逻辑表达式，简称为逻辑式。它是描述逻辑函数与逻辑变量之间关系的表达式，逻辑式和真值表都是描述逻辑函数的重要工具。

有一些较为复杂的逻辑式也是由基本运算符组合而成的。在逻辑式中，相同运算符的运算次序是 **先左后右**，而不同运算符的运算次序是 **非 > 与 > 异或**，若有括号，则 **先进行括号内运算**。

!!! example
    逻辑式 $A \land \lnot B \land \lnot C \oplus \lnot A \land B \land \lnot C \oplus \lnot A \land \lnot B \land C$ ，读作 A 与 B 非 与 C 非 异或 A 非 与 B 与 C 非 异或 A 非 与 B 非 与 C。计算时先计算六个非运算，然后再计算六个与运算，最后再计算两个异或运算。

##### 逻辑等价

设有两个逻辑函数：

$$F_1(A_1, A_2, \cdots, A_n)$$

$$F_2(A_1, A_2, \cdots, A_n)$$

如果对于 $A_1$ ~ $A_n$ 的任何一组取值使 $F_1$ 和 $F_2$ 具有相同的值，则称这两个逻辑函数相等或等价，既 $F_1 = F_2$。相等的逻辑函数一定有相同的真值表，反之亦然。

!!! example
    对于逻辑表达式 $\lnot (\lnot A \land \lnot B)$ ：

    输入 00 时 $\lnot (\lnot 0 \land \lnot 0) = \lnot (1 \land 1) = \lnot 1 = 0$ ；
    输入 01 时 $\lnot (\lnot 0 \land \lnot 1) = \lnot (1 \land 0) = \lnot 0 = 1$ ；
    输入 10 时 $\lnot (\lnot 1 \land \lnot 0) = \lnot (0 \land 1) = \lnot 0 = 1$ ；
    输入 11 时 $\lnot (\lnot 1 \land \lnot 1) = \lnot (0 \land 0) = \lnot 0 = 1$ 。

    进行与、异或、非运算时可以通过查上一节的真值表得到结果。

#### 1.2.8 其它常用逻辑运算

在电路中，除了与、异或、非三种基本逻辑运算外，也有一些常用的逻辑运算。

##### 或（OR）

或运算用符号“ $\lor$ ”表示，称为或。

或运算是二元运算，在输入中有至少一个 1 时，输出为 1；全部输入为 0 时输出为 0。

两个变量的或运算的逻辑表达式为：

$$A \lor B$$

!!! info
    读作 A 或 B。

两个变量或运算的真值表为：

| > | 输入 | 输出 |
| --- | --- | --- |
| A | B | Y |
| 0 | 0 | 0 |
| 0 | 1 | 0 |
| 1 | 0 | 0 |
| 1 | 1 | 1 |

$n$ 个变量或运算的逻辑表达式为：

$$A_1 \lor A_2 \lor \cdots \lor A_n$$

!!! tip
    或满足结合律，多个变量或和多个变量两两或等价。

    $$A_1 \lor A_2 \lor \cdots \lor A_n = (( \cdots ((A_1 \lor A_2) \lor A_3) \lor \cdots) \lor A_n)$$

!!! info
    或运算的逻辑表达式也可以用与、异或、非来表示：

    $$A \lor B = \lnot (\lnot A \land \lnot B)$$

    两者等价的证明已于上一节完成。

##### 独热（One-hot）

独热运算用函数“ $\mathrm{OneHot}$ ”表示，称为独热。

独热运算是多元运算，在全部输入中只有一个输入为 1 时，输出为 1；其余情况输出为 0。

!!! info
    独热运算得名于独热码检测，只有在输入为独热码时输出为 1，非独热码时为 0。

两个变量独热运算的逻辑表达式为：

$$\mathrm{OneHot}(A, B)$$

!!! info
    读作独热 A, B。

两个变量独热运算的真值表为：

| > | 输入 | 输出 |
| --- | --- | --- |
| A | B | Y |
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 0 |

!!! tip 
    可以发现两个变量独热运算和异或运算输出完全相同：
    
    $$\mathrm{OneHot}(A, B) = A \oplus B$$
    
    但是当输入变量在三个或以上时，独热运算和异或运算不同。

    !!! example
        三个变量异或的真值表是：

        | > | > | 输入 | 输出 |
        | --- | --- | --- | --- |
        | A | B | C | Y |
        | 0 | 0 | 0 | 0 |
        | 0 | 0 | 1 | 1 |
        | 0 | 1 | 0 | 1 |
        | 0 | 1 | 1 | 0 |
        | 1 | 0 | 0 | 1 |
        | 1 | 0 | 1 | 0 |
        | 1 | 1 | 0 | 0 |
        | 1 | 1 | 1 | 1 |

        三个变量独热运算的真值表是：

        | > | > | 输入 | 输出 |
        | --- | --- | --- | --- |
        | A | B | C | Y |
        | 0 | 0 | 0 | 0 |
        | 0 | 0 | 1 | 1 |
        | 0 | 1 | 0 | 1 |
        | 0 | 1 | 1 | 0 |
        | 1 | 0 | 0 | 1 |
        | 1 | 0 | 1 | 0 |
        | 1 | 1 | 0 | 0 |
        | 1 | 1 | 1 | 0 |

        可以发现在三个输入全为 1 时异或和独热的结果不同。

$n$ 个变量独热运算的逻辑表达式为：

$$\mathrm{OneHot}(A_1, A_2, \cdots , A_n)$$

!!! tip
    独热不满足结合律，多个变量独热和多个变量两两独热不等价。多个变量独热运算需要同时考虑所有输入，不能两两分别运算。

    $$\mathrm{OneHot}(A_1, A_2, \cdots, A_n) \neq \\ \mathrm{OneHot}(\mathrm{OneHot}( \cdots \mathrm{OneHot}(\mathrm{OneHot}(A_1, A_2), A_3), \cdots A_{n - 1}), A_n)$$

    !!! example
        上述三变量输入独热和异或的例子中，全部输入为 1 的情况独热和异或输出不同（两两异或与两两独热输出相同）。

        $\mathrm{OneHot}(1, 1, 1) = 0$

        $\mathrm{OneHot}(\mathrm{OneHot}(1, 1), 1) = \mathrm{OneHot}(0, 1) = 1$

        $\mathrm{OneHot}(1, 1, 1) \neq \mathrm{OneHot}(\mathrm{OneHot}(1, 1), 1)$

        $\mathrm{OneHot}(A_1, A_2, A_3) \neq \mathrm{OneHot}(\mathrm{OneHot}(A_1, A_2), A_3)$

!!! info
    独热运算的逻辑表达式也可以用与、异或、非来表示：

    两个变量：$A \oplus B$；

    三个变量：$A \land B \land C \oplus A \oplus B \oplus C$；

    四个变量：$A \land B \land C \oplus A \land B \land D \oplus A \land C \land D \oplus B \land C \land D \oplus A \oplus B \oplus C \oplus D$；

    ……

    详细推导过程会在后文介绍。

!!! info
    泰拉瑞亚的异或逻辑门的逻辑是独热，而不是异或，详细内容会在后文介绍。

##### 与非（NAND）、或非（NOR）、同或（XNOR）、独热非（Not One-hot）

与非、或非、同或、独热非运算的结果是对与、或、异或、独热运算的结果取反，是对输入先进行与、或、异或、独热运算，再对运算结果进行非运算。

两个变量和 $n$ 个变量与非、或非、同或、独热非运算的逻辑表达式为：

| > | 运算 | 两个变量逻辑表达式 | $n$ 个变量逻辑表达式 |
| --- | --- | --- | --- |
| 与 | AND | $A \land B$ | $A_1 \land A_2 \land \cdots \land A_n$ |
| 与非 | NAND | $\lnot (A \land B)$ | $\lnot (A_1 \land A_2 \land \cdots \land A_n)$ 
| 或 | OR | $A \lor B$ | $A_1 \lor A_2 \lor \cdots \lor A_n$ |
| 或非 | NOR | $\lnot (A \lor B)$ | $\lnot (A_1 \lor A_2 \lor \cdots \lor A_n)$ |
| 异或 | XOR | $A \oplus B$ | $A_1 \oplus A_2 \oplus \cdots \oplus A_n$ |
| 同或 | XNOR |  $\lnot (A \oplus B)$ | $\lnot (A_1 \oplus A_2 \oplus \cdots \oplus A_n)$ |
| 独热 | One-hot | $\mathrm{OneHot}(A, B)$ | $\mathrm{OneHot}(A_1, A_2, \cdots, A_n)$ |
| 独热非 | Not One-hot | $\lnot \mathrm{OneHot}(A, B)$ | $\lnot \mathrm{OneHot}(A_1, A_2, \cdots, A_n)$ |

与非、或非、同或、独热非运算并没有引入新的运算符，它们的真值表可自行推导。
